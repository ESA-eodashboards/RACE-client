import{r as h,p as W,m as I,ai as q,a as E,o as x,D as i,w as a,am as L,I as s,g as t,b as w,j as F,av as O,h as S,c as P,K as H}from"./framework.DbRhnodN.js";import{_ as X,bh as K,V as c,a$ as j}from"./eo-dash.DHpKoOGB.js";import Y from"./SpeciesList-C5F3mfZo.Bks4_MUd.js";import{V as Q}from"./VDialog-Dz28gzDm.CUnTpmlU.js";import{V as D,a as N,b as T,c as V,d as A}from"./VCard-Cx1eULAJ.RV86hD34.js";import"./item.Bx-rtsOD.js";import"./commonjsHelpers.BosuxZz1.js";import"./forwardRefs-DvyqDzh_.CSaH2hn3.js";import"./transition-DC6SPZ8l.BHbzSU7J.js";import"./VImg-E4FJs1D6.CpEmigzh.js";function Ve(n,y){const g=[...n].filter(u=>u!==0).sort((u,d)=>u-d),m=y/100*(g.length-1);return g[Math.round(m)]}function J(n,y){const[g,m,u,d]=y;return n[0]>=g&&n[0]<=u&&n[1]>=m&&n[1]<=d}async function Z(n){const y=await j.get("https://eox-ideas.s3.eu-central-1.amazonaws.com/indicator2/Species_Index_Images_v2.json").then(o=>o.data),m=(await j.get("https://eox-ideas.s3.eu-central-1.amazonaws.com/indicator2/Europe_characteristic_species.geojson").then(o=>o.data)).features.filter(o=>J(o.geometry.coordinates,n)).flatMap(o=>o.properties.species_indices).map(o=>y.find(r=>r.index===o)).filter(o=>o!=null).reduce((o,r)=>(o[r.index]?o[r.index].count++:o[r.index]={...r,count:1},o),{}),u=Object.values(m).sort((o,r)=>r.count-o.count),d=u.filter(o=>o.common_name&&o.common_name!=="Unknown");return d.length<5?u.slice(0,5):d.slice(0,5)}const _=".btn-remaining[data-v-67b630dc]{border-radius:0 0 4px 4px!important}.eodash-newsletter-banner[data-v-67b630dc]{position:relative}.eodash-newsletter-banner .close-button[data-v-67b630dc]{position:absolute;right:18px;top:18px;width:32px;height:32px;cursor:pointer}.mobile-modal[data-v-67b630dc]{position:fixed;inset:0}.game-stats[data-v-67b630dc]{display:flex;flex-direction:column;align-items:center;margin:20px 0}.game-stats .item[data-v-67b630dc]{display:flex;flex-direction:column;align-items:center;margin-bottom:16px}.game-stats .item .name[data-v-67b630dc]{font-weight:500;font-size:16px}.game-stats .item .value[data-v-67b630dc]{font-size:24px;margin-top:8px;font-weight:600}.fullwidth[data-v-67b630dc]{left:0;top:0}",ee={class:"modal-success d-flex flex-column fill-height fill-width"},te={key:0},ne={key:1},se={class:"game-stats"},oe={class:"item"},ie={class:"value"},ae={class:"item"},le={class:"value"},re={class:"item"},de={class:"value"},me={key:0},ue={key:0,class:"pa-2"},fe={class:"game-stats"},ge={class:"item"},pe={class:"value"},ve={class:"item"},be={class:"value"},xe={class:"item"},ce={class:"value"},ye={key:0},we={__name:"MinesweeperDialog",props:{mode:{type:String,default:"start"},isEnabled:{type:Boolean,default:!1},game:{type:[Object,null],required:!0},elapsedSeconds:{type:Number,required:!0},bbox:{type:Array,default:()=>[]},enableSpeciesDisplay:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:y}){const{indicator:g}=K.states,m=h(n.isEnabled);W(()=>{U()});const u=y;I(()=>n.bbox,U),I(()=>n.isEnabled,f=>{m.value=f});const d=h([]),o=q("copy-btn");function r(){u("close"),m.value=!1}function G(){document.dispatchEvent(new Event("minesweeper:start")),r()}function B(){document.dispatchEvent(new Event("minesweeper:restart")),r()}async function U(){if(n.enableSpeciesDisplay){if(n.bbox.length!==4){console.error("Bounding box must be in format [minLong, minLat, maxLong, maxLat]!");return}d.value=await Z(n.bbox)}}function R(){var l,p,v,b,C,M,k;if(!o.value)return;const f=new Date;let e;n.mode==="win"?e=`âœ¨ #EOxMinesweeper Challenge ${f.getDate()}.${f.getMonth()+1}.${f.getFullYear()}
  
  ðŸŒŸ  TOTAL ELAPSED TIME: ${n.elapsedSeconds} seconds
  ðŸ”³  NUMBER OF CELLS:    ${(p=(l=n.game)==null?void 0:l.game)==null?void 0:p.fieldCount}
  ðŸ’£  NUMBER OF MINES:    ${(b=(v=n.game)==null?void 0:v.game)==null?void 0:b.mineCount}`:n.mode==="gameover"&&(e=`âœ¨ #EOxMinesweeper Challenge ${f.getDate()}.${f.getMonth()+1}.${f.getFullYear()}
  
  ðŸŒŸ  TOTAL UNCOVERED AREA: ${Math.round(((C=n.game)==null?void 0:C.game.getUncoveredAreaPercent())*100)}%
  ðŸ”³  NUMBER OF CELLS:      ${(M=n.game)==null?void 0:M.game.fieldCount}
  ðŸ’£  NUMBER OF MINES:      ${(k=n.game)==null?void 0:k.game.mineCount}`),n.enableSpeciesDisplay&&(e+=`

Discovered species:
`,e+=d.value.reduce((z,$)=>`${z}${$.species}${$.common_name==="Unknown"?"":` - ${$.common_name}`}
`,"")),navigator.clipboard.writeText(e??""),o.value.$el.innerText="Copied!"}return(f,e)=>(x(),E("div",ee,[i(Q,{modelValue:m.value,"onUpdate:modelValue":e[7]||(e[7]=l=>m.value=l),width:"500"},{activator:a(({props:l})=>[i(c,H({color:"secondary",height:"100%",class:"btn-remaining align-strech"},l),{default:a(()=>e[8]||(e[8]=[s(" ðŸ’£ Open game dialog ")])),_:2,__:[8]},1040)]),default:a(()=>[L(i(D,null,{default:a(()=>[i(N,{style:{"text-align":"center"},class:"py-6"},{default:a(()=>e[9]||(e[9]=[s(" ðŸ’£ Hexagonal Minesweeper Game ")])),_:1,__:[9]}),i(T,null,{default:a(()=>[e[20]||(e[20]=t("p",null," Welcome to the Minesweeper game mode! For more information look at the Description in the Information panel! ",-1)),e[21]||(e[21]=t("p",null,[t("b",null,"Quick overview:"),t("br")],-1)),t("ul",null,[t("li",null,[e[10]||(e[10]=s(" The goal of the game is to ")),e[11]||(e[11]=t("b",null,"UNCOVER (left-click)",-1)),e[12]||(e[12]=s(" most tiles possible that do not have a 'mine', or in other words, tiles corresponding to areas with high ")),F(g)==="IND1_1_minesweeper"?(x(),E("span",te,"health risks")):w("v-if",!0),F(g)==="IND2_1_minesweeper"?(x(),E("span",ne,"biodiversity")):w("v-if",!0),e[13]||(e[13]=s(". Your ")),e[14]||(e[14]=t("b",null,"score",-1)),e[15]||(e[15]=s(" is based on ")),e[16]||(e[16]=t("b",null,"the percentage of uncovered area and time spent",-1)),e[17]||(e[17]=s(" at the end of the game. "))]),e[18]||(e[18]=t("li",null,[s(" You can "),t("b",null,"FLAG (right-click)"),s(" the tiles with 'mines' (i.e. areas with very high health risk) to indicate they have a 'mine'. ")],-1)),e[19]||(e[19]=t("li",null,[t("b",null,"Hint:"),s(" Use visible layers to guide your exploration and uncover new tiles (left-click). ")],-1))]),e[22]||(e[22]=t("p",null,[s(" A new location is available "),t("b",null,"daily"),s(" â€” come back tomorrow to explore more ! ")],-1)),e[23]||(e[23]=t("p",null,[s("Or use the "),t("b",null,"time selection"),s(" to browse through different game areas.")],-1))]),_:1,__:[20,21,22,23]}),i(V,null,{default:a(()=>[i(A),i(c,{class:"green white--text",text:"",onClick:e[0]||(e[0]=l=>G())},{default:a(()=>e[24]||(e[24]=[s("Start Game")])),_:1,__:[24]})]),_:1})]),_:1},512),[[O,n.mode==="start"]]),L(i(D,null,{default:a(()=>[i(N,{style:{"text-align":"center"},class:"py-6"},{default:a(()=>e[25]||(e[25]=[s("Oh no!")])),_:1,__:[25]}),i(T,null,{default:a(()=>{var l,p,v,b,C,M;return[t("div",se,[t("div",oe,[e[26]||(e[26]=t("span",{class:"name"},"ðŸŒŸ TOTAL UNCOVERED AREA",-1)),t("span",ie,S(Math.round((((p=(l=n.game)==null?void 0:l.game)==null?void 0:p.getUncoveredAreaPercent())??0)*100))+"% ",1)]),t("div",ae,[e[27]||(e[27]=t("span",{class:"name"},"â¬¡ NUMBER OF CELLS",-1)),t("span",le,S((b=(v=n.game)==null?void 0:v.game)==null?void 0:b.fieldCount),1)]),t("div",re,[e[28]||(e[28]=t("span",{class:"name"},"ðŸ’£ NUMBER OF MINES",-1)),t("span",de,S((M=(C=n.game)==null?void 0:C.game)==null?void 0:M.mineCount),1)]),n.enableSpeciesDisplay?(x(),E("div",me,[n.mode==="gameover"?(x(),E("h1",ue,"Species Info")):w("v-if",!0),n.mode==="gameover"?(x(),P(Y,{key:1,species:d.value},null,8,["species"])):w("v-if",!0)])):w("v-if",!0),i(c,{style:{"font-weight":"bold"},ref:"copy-btn",color:"secondary",text:"",onClick:e[1]||(e[1]=k=>R())},{default:a(()=>e[29]||(e[29]=[s("COPY RESULTS")])),_:1,__:[29]},512),e[30]||(e[30]=t("p",null,"Share your score on social media!",-1)),e[31]||(e[31]=t("p",null,[t("b",null,"Come back tomorrow"),s(" for a new challenge and explore a fresh location! ")],-1))])]}),_:1}),i(V,null,{default:a(()=>[i(A),i(c,{text:"",onClick:e[2]||(e[2]=l=>B())},{default:a(()=>e[32]||(e[32]=[s("Restart Game")])),_:1,__:[32]}),i(c,{class:"primary",text:"",onClick:e[3]||(e[3]=l=>r())},{default:a(()=>e[33]||(e[33]=[s("Continue")])),_:1,__:[33]})]),_:1})]),_:1},512),[[O,n.mode==="gameover"]]),L(i(D,null,{default:a(()=>[i(N,{style:{"text-align":"center"},class:"py-6"},{default:a(()=>e[34]||(e[34]=[s("Woo-hoo! ðŸŽ‰")])),_:1,__:[34]}),i(T,null,{default:a(()=>{var l,p,v,b;return[e[40]||(e[40]=s(" Congratulations, you uncovered all fields without stepping on a mine! ")),t("div",fe,[t("div",ge,[e[35]||(e[35]=t("span",{class:"name"},"ðŸŒŸ TOTAL ELAPSED TIME",-1)),t("span",pe,S(n.elapsedSeconds)+"s",1)]),t("div",ve,[e[36]||(e[36]=t("span",{class:"name"},"â¬¡ NUMBER OF CELLS",-1)),t("span",be,S((p=(l=n.game)==null?void 0:l.game)==null?void 0:p.fieldCount),1)]),t("div",xe,[e[37]||(e[37]=t("span",{class:"name"},"ðŸ’£ NUMBER OF MINES",-1)),t("span",ce,S((b=(v=n.game)==null?void 0:v.game)==null?void 0:b.mineCount),1)]),n.enableSpeciesDisplay?(x(),E("div",ye,[e[38]||(e[38]=t("h2",{style:{"margin-top":"24px","margin-bottom":"18px"}}," Discovered species: ",-1)),n.mode==="win"?(x(),P(Y,{key:0,species:d.value},null,8,["species"])):w("v-if",!0)])):w("v-if",!0),i(c,{style:{"font-weight":"bold"},ref:"copy-btn",color:"secondary",text:"",onClick:e[4]||(e[4]=C=>R())},{default:a(()=>e[39]||(e[39]=[s("Copy to Clipboard")])),_:1,__:[39]},512)]),e[41]||(e[41]=t("p",null,"Share your score on social media!",-1)),e[42]||(e[42]=t("p",null,[t("b",null,"Come back tomorrow"),s(" for a new challenge and explore a fresh location! ")],-1))]}),_:1,__:[40,41,42]}),i(V,null,{default:a(()=>[i(A),i(c,{text:"",onClick:e[5]||(e[5]=l=>B())},{default:a(()=>e[43]||(e[43]=[s("Restart Game")])),_:1,__:[43]}),i(c,{class:"primary",text:"",onClick:e[6]||(e[6]=l=>r())},{default:a(()=>e[44]||(e[44]=[s("Continue")])),_:1,__:[44]})]),_:1})]),_:1},512),[[O,n.mode==="win"]])]),_:1},8,["modelValue"])]))}},Ce=X(we,[["styles",[_]],["__scopeId","data-v-67b630dc"]]),Ae=Object.freeze(Object.defineProperty({__proto__:null,default:Ce},Symbol.toStringTag,{value:"Module"}));export{Ce as M,Ae as a,Ve as g};
