import{p as I,v as q,q as F,aM as z,c as E,o as y,G as o,w as l,as as $,a as i,j as t,e as c,k as P,aS as O,t as S,b as j,K as H}from"./framework.D29bnCpw.js";import{y as X,au as K,V as w,P as G}from"./eo-dash.BxAoZc9W.js";import Y from"./SpeciesList-CYpv4YB7.B1abVokN.js";import{V as Q}from"./VDialog-8vQcO2FR.G7zucyZf.js";import{V as D,a as N,b as T,c as V,d as A}from"./VCard-DhF8VIXI.CuppnkXY.js";import"./commonjsHelpers.BosuxZz1.js";import"./VOverlay-DjjbbHLu.AZd-SVza.js";import"./forwardRefs-C02JHty5.iJahe9xW.js";import"./transition-B8PobWyH.CFvII9FI.js";import"./VImg-BzFynKB1.DrnXsHVZ.js";function Te(n,x){const g=[...n].filter(m=>m!==0).sort((m,d)=>m-d),u=x/100*(g.length-1);return g[Math.round(u)]}function J(n,x){const[g,u,m,d]=x;return n[0]>=g&&n[0]<=m&&n[1]>=u&&n[1]<=d}async function Z(n){const x=await G.get("https://eox-ideas.s3.eu-central-1.amazonaws.com/indicator2/Species_Index_Images_v2.json").then(s=>s.data),u=(await G.get("https://eox-ideas.s3.eu-central-1.amazonaws.com/indicator2/Europe_characteristic_species.geojson").then(s=>s.data)).features.filter(s=>J(s.geometry.coordinates,n)).flatMap(s=>s.properties.species_indices).map(s=>x.find(r=>r.index===s)).filter(s=>s!=null).reduce((s,r)=>(s[r.index]?s[r.index].count++:s[r.index]={...r,count:1},s),{}),m=Object.values(u).sort((s,r)=>r.count-s.count),d=m.filter(s=>s.common_name&&s.common_name!=="Unknown");return d.length<5?m.slice(0,5):d.slice(0,5)}const _={class:"modal-success d-flex flex-column fill-height fill-width"},ee={key:0},te={key:1},ne={class:"game-stats"},se={class:"item"},oe={class:"value"},ie={class:"item"},le={class:"value"},ae={class:"item"},re={class:"value"},de={key:0},ue={key:0,class:"pa-2"},me={class:"game-stats"},fe={class:"item"},ge={class:"value"},pe={class:"item"},ve={class:"value"},be={class:"item"},ye={class:"value"},we={key:0},xe={__name:"MinespweeperDialog",props:{mode:{type:String,default:"start"},isEnabled:{type:Boolean,default:!1},game:{type:[Object,null],required:!0},elapsedSeconds:{type:Number,required:!0},bbox:{type:Array,default:()=>[]},enableSpeciesDisplay:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:x}){const{indicator:g}=K.states,u=I(n.isEnabled);q(()=>{U()});const m=x;F(()=>n.bbox,U),F(()=>n.isEnabled,f=>{u.value=f});const d=I([]),s=z("copy-btn");function r(){m("close"),u.value=!1}function W(){document.dispatchEvent(new Event("minesweeper:start")),r()}function B(){document.dispatchEvent(new Event("minesweeper:restart")),r()}async function U(){if(n.enableSpeciesDisplay){if(n.bbox.length!==4){console.error("Bounding box must be in format [minLong, minLat, maxLong, maxLat]!");return}d.value=await Z(n.bbox)}}function R(){var a,p,v,b,C,M,k;if(!s.value)return;const f=new Date;let e;n.mode==="win"?e=`âœ¨ #EOxMinesweeper Challenge ${f.getDate()}.${f.getMonth()+1}.${f.getFullYear()}
  
  ðŸŒŸ  TOTAL ELAPSED TIME: ${n.elapsedSeconds} seconds
  ðŸ”³  NUMBER OF CELLS:    ${(p=(a=n.game)==null?void 0:a.game)==null?void 0:p.fieldCount}
  ðŸ’£  NUMBER OF MINES:    ${(b=(v=n.game)==null?void 0:v.game)==null?void 0:b.mineCount}`:n.mode==="gameover"&&(e=`âœ¨ #EOxMinesweeper Challenge ${f.getDate()}.${f.getMonth()+1}.${f.getFullYear()}
  
  ðŸŒŸ  TOTAL UNCOVERED AREA: ${Math.round(((C=n.game)==null?void 0:C.game.getUncoveredAreaPercent())*100)}%
  ðŸ”³  NUMBER OF CELLS:      ${(M=n.game)==null?void 0:M.game.fieldCount}
  ðŸ’£  NUMBER OF MINES:      ${(k=n.game)==null?void 0:k.game.mineCount}`),n.enableSpeciesDisplay&&(e+=`

Discovered species:
`,e+=d.value.reduce((h,L)=>`${h}${L.species}${L.common_name==="Unknown"?"":` - ${L.common_name}`}
`,"")),navigator.clipboard.writeText(e??""),s.value.$el.innerText="Copied!"}return(f,e)=>(y(),E("div",_,[o(Q,{modelValue:u.value,"onUpdate:modelValue":e[7]||(e[7]=a=>u.value=a),width:"500"},{activator:l(({props:a})=>[o(w,H({color:"secondary",height:"100%",class:"btn-remaining align-strech"},a),{default:l(()=>e[8]||(e[8]=[i(" ðŸ’£ Open game dialog ")])),_:2},1040)]),default:l(()=>[$(o(D,null,{default:l(()=>[o(N,{style:{"text-align":"center"},class:"py-6"},{default:l(()=>e[9]||(e[9]=[i(" ðŸ’£ Hexagonal Minesweeper Game ")])),_:1}),o(T,null,{default:l(()=>[e[20]||(e[20]=t("p",null," Welcome to the Minesweeper game mode! For more information look at the Description in the Information panel! ",-1)),e[21]||(e[21]=t("p",null,[t("b",null,"Quick overview:"),t("br")],-1)),t("ul",null,[t("li",null,[e[10]||(e[10]=i(" The goal of the game is to ")),e[11]||(e[11]=t("b",null,"UNCOVER (left-click)",-1)),e[12]||(e[12]=i(" most tiles possible that do not have a 'mine', or in other words, tiles corresponding to areas with high ")),P(g)==="IND1_1_minesweeper"?(y(),E("span",ee,"health risks")):c("v-if",!0),P(g)==="IND2_1_minesweeper"?(y(),E("span",te,"biodiversity")):c("v-if",!0),e[13]||(e[13]=i(". Your ")),e[14]||(e[14]=t("b",null,"score",-1)),e[15]||(e[15]=i(" is based on ")),e[16]||(e[16]=t("b",null,"the percentage of uncovered area and time spent",-1)),e[17]||(e[17]=i(" at the end of the game. "))]),e[18]||(e[18]=t("li",null,[i(" You can "),t("b",null,"FLAG (right-click)"),i(" the tiles with 'mines' (i.e. areas with very high health risk) to indicate they have a 'mine'. ")],-1)),e[19]||(e[19]=t("li",null,[t("b",null,"Hint:"),i(" Use visible layers to guide your exploration and uncover new tiles (left-click). ")],-1))]),e[22]||(e[22]=t("p",null,[i(" A new location is available "),t("b",null,"daily"),i(" â€” come back tomorrow to explore more! ")],-1))]),_:1}),o(V,null,{default:l(()=>[o(A),o(w,{class:"green white--text",text:"",onClick:e[0]||(e[0]=a=>W())},{default:l(()=>e[23]||(e[23]=[i("Start Game")])),_:1})]),_:1})]),_:1},512),[[O,n.mode==="start"]]),$(o(D,null,{default:l(()=>[o(N,{style:{"text-align":"center"},class:"py-6"},{default:l(()=>e[24]||(e[24]=[i("Oh no!")])),_:1}),o(T,null,{default:l(()=>{var a,p,v,b,C,M;return[t("div",ne,[t("div",se,[e[25]||(e[25]=t("span",{class:"name"},"ðŸŒŸ TOTAL UNCOVERED AREA",-1)),t("span",oe,S(Math.round((((p=(a=n.game)==null?void 0:a.game)==null?void 0:p.getUncoveredAreaPercent())??0)*100))+"% ",1)]),t("div",ie,[e[26]||(e[26]=t("span",{class:"name"},"â¬¡ NUMBER OF CELLS",-1)),t("span",le,S((b=(v=n.game)==null?void 0:v.game)==null?void 0:b.fieldCount),1)]),t("div",ae,[e[27]||(e[27]=t("span",{class:"name"},"ðŸ’£ NUMBER OF MINES",-1)),t("span",re,S((M=(C=n.game)==null?void 0:C.game)==null?void 0:M.mineCount),1)]),n.enableSpeciesDisplay?(y(),E("div",de,[n.mode==="gameover"?(y(),E("h1",ue,"Species Info")):c("v-if",!0),n.mode==="gameover"?(y(),j(Y,{key:1,species:d.value},null,8,["species"])):c("v-if",!0)])):c("v-if",!0),o(w,{style:{"font-weight":"bold"},ref:"copy-btn",color:"secondary",text:"",onClick:e[1]||(e[1]=k=>R())},{default:l(()=>e[28]||(e[28]=[i("COPY RESULTS")])),_:1},512),e[29]||(e[29]=t("p",null,"Share your score on social media!",-1)),e[30]||(e[30]=t("p",null,[t("b",null,"Come back tomorrow"),i(" for a new challenge and explore a fresh location! ")],-1))])]}),_:1}),o(V,null,{default:l(()=>[o(A),o(w,{text:"",onClick:e[2]||(e[2]=a=>B())},{default:l(()=>e[31]||(e[31]=[i("Restart Game")])),_:1}),o(w,{class:"primary",text:"",onClick:e[3]||(e[3]=a=>r())},{default:l(()=>e[32]||(e[32]=[i("Continue")])),_:1})]),_:1})]),_:1},512),[[O,n.mode==="gameover"]]),$(o(D,null,{default:l(()=>[o(N,{style:{"text-align":"center"},class:"py-6"},{default:l(()=>e[33]||(e[33]=[i("Woo-hoo! ðŸŽ‰")])),_:1}),o(T,null,{default:l(()=>{var a,p,v,b;return[e[39]||(e[39]=i(" Congratulations, you uncovered all fields without stepping on a mine! ")),t("div",me,[t("div",fe,[e[34]||(e[34]=t("span",{class:"name"},"ðŸŒŸ TOTAL ELAPSED TIME",-1)),t("span",ge,S(n.elapsedSeconds)+"s",1)]),t("div",pe,[e[35]||(e[35]=t("span",{class:"name"},"â¬¡ NUMBER OF CELLS",-1)),t("span",ve,S((p=(a=n.game)==null?void 0:a.game)==null?void 0:p.fieldCount),1)]),t("div",be,[e[36]||(e[36]=t("span",{class:"name"},"ðŸ’£ NUMBER OF MINES",-1)),t("span",ye,S((b=(v=n.game)==null?void 0:v.game)==null?void 0:b.mineCount),1)]),n.enableSpeciesDisplay?(y(),E("div",we,[e[37]||(e[37]=t("h2",{style:{"margin-top":"24px","margin-bottom":"18px"}}," Discovered species: ",-1)),n.mode==="win"?(y(),j(Y,{key:0,species:d.value},null,8,["species"])):c("v-if",!0)])):c("v-if",!0),o(w,{style:{"font-weight":"bold"},ref:"copy-btn",color:"secondary",text:"",onClick:e[4]||(e[4]=C=>R())},{default:l(()=>e[38]||(e[38]=[i("Copy to Clipboard")])),_:1},512)]),e[40]||(e[40]=t("p",null,"Share your score on social media!",-1)),e[41]||(e[41]=t("p",null,[t("b",null,"Come back tomorrow"),i(" for a new challenge and explore a fresh location! ")],-1))]}),_:1}),o(V,null,{default:l(()=>[o(A),o(w,{text:"",onClick:e[5]||(e[5]=a=>B())},{default:l(()=>e[42]||(e[42]=[i("Restart Game")])),_:1}),o(w,{class:"primary",text:"",onClick:e[6]||(e[6]=a=>r())},{default:l(()=>e[43]||(e[43]=[i("Continue")])),_:1})]),_:1})]),_:1},512),[[O,n.mode==="win"]])]),_:1},8,["modelValue"])]))}},ce=X(xe,[["__scopeId","data-v-2f488aab"]]),Ve=Object.freeze(Object.defineProperty({__proto__:null,default:ce},Symbol.toStringTag,{value:"Module"}));export{ce as M,Ve as a,Te as g};
