import{p as I,v as q,q as F,aM as z,c as E,o as y,G as l,w as i,as as L,a as s,j as t,e as c,k as P,aS as O,t as S,b as j,K as H}from"./framework.D29bnCpw.js";import{y as X,au as K,V as w,P as G}from"./eo-dash.loQ37NQN.js";import Y from"./SpeciesList-DS8p_dD1.DsEJJ_qT.js";import{V as Q}from"./VDialog-1iF_f8zx.CpSS_Dw7.js";import{V as D,a as N,b as T,c as V,d as A}from"./VCard-CsxOKCip.By-kW07h.js";import"./commonjsHelpers.BosuxZz1.js";import"./VOverlay-BCbdkP_b.CU7SdSi6.js";import"./forwardRefs-DKKu2WoA.z5x_6aaA.js";import"./transition-mKhpQC11.D26DQJUp.js";import"./VImg-B4ag29C4.o5NkbPzr.js";function Te(n,x){const g=[...n].filter(m=>m!==0).sort((m,d)=>m-d),u=x/100*(g.length-1);return g[Math.round(u)]}function J(n,x){const[g,u,m,d]=x;return n[0]>=g&&n[0]<=m&&n[1]>=u&&n[1]<=d}async function Z(n){const x=await G.get("https://eox-ideas.s3.eu-central-1.amazonaws.com/indicator2/Species_Index_Images_v2.json").then(o=>o.data),u=(await G.get("https://eox-ideas.s3.eu-central-1.amazonaws.com/indicator2/Europe_characteristic_species.geojson").then(o=>o.data)).features.filter(o=>J(o.geometry.coordinates,n)).flatMap(o=>o.properties.species_indices).map(o=>x.find(r=>r.index===o)).filter(o=>o!=null).reduce((o,r)=>(o[r.index]?o[r.index].count++:o[r.index]={...r,count:1},o),{}),m=Object.values(u).sort((o,r)=>r.count-o.count),d=m.filter(o=>o.common_name&&o.common_name!=="Unknown");return d.length<5?m.slice(0,5):d.slice(0,5)}const _={class:"modal-success d-flex flex-column fill-height fill-width"},ee={key:0},te={key:1},ne={class:"game-stats"},se={class:"item"},oe={class:"value"},le={class:"item"},ie={class:"value"},ae={class:"item"},re={class:"value"},de={key:0},ue={key:0,class:"pa-2"},me={class:"game-stats"},fe={class:"item"},ge={class:"value"},pe={class:"item"},ve={class:"value"},be={class:"item"},ye={class:"value"},we={key:0},xe={__name:"MinesweeperDialog",props:{mode:{type:String,default:"start"},isEnabled:{type:Boolean,default:!1},game:{type:[Object,null],required:!0},elapsedSeconds:{type:Number,required:!0},bbox:{type:Array,default:()=>[]},enableSpeciesDisplay:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:x}){const{indicator:g}=K.states,u=I(n.isEnabled);q(()=>{U()});const m=x;F(()=>n.bbox,U),F(()=>n.isEnabled,f=>{u.value=f});const d=I([]),o=z("copy-btn");function r(){m("close"),u.value=!1}function h(){document.dispatchEvent(new Event("minesweeper:start")),r()}function B(){document.dispatchEvent(new Event("minesweeper:restart")),r()}async function U(){if(n.enableSpeciesDisplay){if(n.bbox.length!==4){console.error("Bounding box must be in format [minLong, minLat, maxLong, maxLat]!");return}d.value=await Z(n.bbox)}}function R(){var a,p,v,b,C,M,k;if(!o.value)return;const f=new Date;let e;n.mode==="win"?e=`âœ¨ #EOxMinesweeper Challenge ${f.getDate()}.${f.getMonth()+1}.${f.getFullYear()}
  
  ðŸŒŸ  TOTAL ELAPSED TIME: ${n.elapsedSeconds} seconds
  ðŸ”³  NUMBER OF CELLS:    ${(p=(a=n.game)==null?void 0:a.game)==null?void 0:p.fieldCount}
  ðŸ’£  NUMBER OF MINES:    ${(b=(v=n.game)==null?void 0:v.game)==null?void 0:b.mineCount}`:n.mode==="gameover"&&(e=`âœ¨ #EOxMinesweeper Challenge ${f.getDate()}.${f.getMonth()+1}.${f.getFullYear()}
  
  ðŸŒŸ  TOTAL UNCOVERED AREA: ${Math.round(((C=n.game)==null?void 0:C.game.getUncoveredAreaPercent())*100)}%
  ðŸ”³  NUMBER OF CELLS:      ${(M=n.game)==null?void 0:M.game.fieldCount}
  ðŸ’£  NUMBER OF MINES:      ${(k=n.game)==null?void 0:k.game.mineCount}`),n.enableSpeciesDisplay&&(e+=`

Discovered species:
`,e+=d.value.reduce((W,$)=>`${W}${$.species}${$.common_name==="Unknown"?"":` - ${$.common_name}`}
`,"")),navigator.clipboard.writeText(e??""),o.value.$el.innerText="Copied!"}return(f,e)=>(y(),E("div",_,[l(Q,{modelValue:u.value,"onUpdate:modelValue":e[7]||(e[7]=a=>u.value=a),width:"500"},{activator:i(({props:a})=>[l(w,H({color:"secondary",height:"100%",class:"btn-remaining align-strech"},a),{default:i(()=>e[8]||(e[8]=[s(" ðŸ’£ Open game dialog ")])),_:2},1040)]),default:i(()=>[L(l(D,null,{default:i(()=>[l(N,{style:{"text-align":"center"},class:"py-6"},{default:i(()=>e[9]||(e[9]=[s(" ðŸ’£ Hexagonal Minesweeper Game ")])),_:1}),l(T,null,{default:i(()=>[e[20]||(e[20]=t("p",null," Welcome to the Minesweeper game mode! For more information look at the Description in the Information panel! ",-1)),e[21]||(e[21]=t("p",null,[t("b",null,"Quick overview:"),t("br")],-1)),t("ul",null,[t("li",null,[e[10]||(e[10]=s(" The goal of the game is to ")),e[11]||(e[11]=t("b",null,"UNCOVER (left-click)",-1)),e[12]||(e[12]=s(" most tiles possible that do not have a 'mine', or in other words, tiles corresponding to areas with high ")),P(g)==="IND1_1_minesweeper"?(y(),E("span",ee,"health risks")):c("v-if",!0),P(g)==="IND2_1_minesweeper"?(y(),E("span",te,"biodiversity")):c("v-if",!0),e[13]||(e[13]=s(". Your ")),e[14]||(e[14]=t("b",null,"score",-1)),e[15]||(e[15]=s(" is based on ")),e[16]||(e[16]=t("b",null,"the percentage of uncovered area and time spent",-1)),e[17]||(e[17]=s(" at the end of the game. "))]),e[18]||(e[18]=t("li",null,[s(" You can "),t("b",null,"FLAG (right-click)"),s(" the tiles with 'mines' (i.e. areas with very high health risk) to indicate they have a 'mine'. ")],-1)),e[19]||(e[19]=t("li",null,[t("b",null,"Hint:"),s(" Use visible layers to guide your exploration and uncover new tiles (left-click). ")],-1))]),e[22]||(e[22]=t("p",null,[s(" A new location is available "),t("b",null,"daily"),s(" â€” come back tomorrow to explore more ! ")],-1)),e[23]||(e[23]=t("p",null,[s("Or use the "),t("b",null,"time selection"),s(" to browse through different game areas.")],-1))]),_:1}),l(V,null,{default:i(()=>[l(A),l(w,{class:"green white--text",text:"",onClick:e[0]||(e[0]=a=>h())},{default:i(()=>e[24]||(e[24]=[s("Start Game")])),_:1})]),_:1})]),_:1},512),[[O,n.mode==="start"]]),L(l(D,null,{default:i(()=>[l(N,{style:{"text-align":"center"},class:"py-6"},{default:i(()=>e[25]||(e[25]=[s("Oh no!")])),_:1}),l(T,null,{default:i(()=>{var a,p,v,b,C,M;return[t("div",ne,[t("div",se,[e[26]||(e[26]=t("span",{class:"name"},"ðŸŒŸ TOTAL UNCOVERED AREA",-1)),t("span",oe,S(Math.round((((p=(a=n.game)==null?void 0:a.game)==null?void 0:p.getUncoveredAreaPercent())??0)*100))+"% ",1)]),t("div",le,[e[27]||(e[27]=t("span",{class:"name"},"â¬¡ NUMBER OF CELLS",-1)),t("span",ie,S((b=(v=n.game)==null?void 0:v.game)==null?void 0:b.fieldCount),1)]),t("div",ae,[e[28]||(e[28]=t("span",{class:"name"},"ðŸ’£ NUMBER OF MINES",-1)),t("span",re,S((M=(C=n.game)==null?void 0:C.game)==null?void 0:M.mineCount),1)]),n.enableSpeciesDisplay?(y(),E("div",de,[n.mode==="gameover"?(y(),E("h1",ue,"Species Info")):c("v-if",!0),n.mode==="gameover"?(y(),j(Y,{key:1,species:d.value},null,8,["species"])):c("v-if",!0)])):c("v-if",!0),l(w,{style:{"font-weight":"bold"},ref:"copy-btn",color:"secondary",text:"",onClick:e[1]||(e[1]=k=>R())},{default:i(()=>e[29]||(e[29]=[s("COPY RESULTS")])),_:1},512),e[30]||(e[30]=t("p",null,"Share your score on social media!",-1)),e[31]||(e[31]=t("p",null,[t("b",null,"Come back tomorrow"),s(" for a new challenge and explore a fresh location! ")],-1))])]}),_:1}),l(V,null,{default:i(()=>[l(A),l(w,{text:"",onClick:e[2]||(e[2]=a=>B())},{default:i(()=>e[32]||(e[32]=[s("Restart Game")])),_:1}),l(w,{class:"primary",text:"",onClick:e[3]||(e[3]=a=>r())},{default:i(()=>e[33]||(e[33]=[s("Continue")])),_:1})]),_:1})]),_:1},512),[[O,n.mode==="gameover"]]),L(l(D,null,{default:i(()=>[l(N,{style:{"text-align":"center"},class:"py-6"},{default:i(()=>e[34]||(e[34]=[s("Woo-hoo! ðŸŽ‰")])),_:1}),l(T,null,{default:i(()=>{var a,p,v,b;return[e[40]||(e[40]=s(" Congratulations, you uncovered all fields without stepping on a mine! ")),t("div",me,[t("div",fe,[e[35]||(e[35]=t("span",{class:"name"},"ðŸŒŸ TOTAL ELAPSED TIME",-1)),t("span",ge,S(n.elapsedSeconds)+"s",1)]),t("div",pe,[e[36]||(e[36]=t("span",{class:"name"},"â¬¡ NUMBER OF CELLS",-1)),t("span",ve,S((p=(a=n.game)==null?void 0:a.game)==null?void 0:p.fieldCount),1)]),t("div",be,[e[37]||(e[37]=t("span",{class:"name"},"ðŸ’£ NUMBER OF MINES",-1)),t("span",ye,S((b=(v=n.game)==null?void 0:v.game)==null?void 0:b.mineCount),1)]),n.enableSpeciesDisplay?(y(),E("div",we,[e[38]||(e[38]=t("h2",{style:{"margin-top":"24px","margin-bottom":"18px"}}," Discovered species: ",-1)),n.mode==="win"?(y(),j(Y,{key:0,species:d.value},null,8,["species"])):c("v-if",!0)])):c("v-if",!0),l(w,{style:{"font-weight":"bold"},ref:"copy-btn",color:"secondary",text:"",onClick:e[4]||(e[4]=C=>R())},{default:i(()=>e[39]||(e[39]=[s("Copy to Clipboard")])),_:1},512)]),e[41]||(e[41]=t("p",null,"Share your score on social media!",-1)),e[42]||(e[42]=t("p",null,[t("b",null,"Come back tomorrow"),s(" for a new challenge and explore a fresh location! ")],-1))]}),_:1}),l(V,null,{default:i(()=>[l(A),l(w,{text:"",onClick:e[5]||(e[5]=a=>B())},{default:i(()=>e[43]||(e[43]=[s("Restart Game")])),_:1}),l(w,{class:"primary",text:"",onClick:e[6]||(e[6]=a=>r())},{default:i(()=>e[44]||(e[44]=[s("Continue")])),_:1})]),_:1})]),_:1},512),[[O,n.mode==="win"]])]),_:1},8,["modelValue"])]))}},ce=X(xe,[["__scopeId","data-v-67b630dc"]]),Ve=Object.freeze(Object.defineProperty({__proto__:null,default:ce},Symbol.toStringTag,{value:"Module"}));export{ce as M,Ve as a,Te as g};
